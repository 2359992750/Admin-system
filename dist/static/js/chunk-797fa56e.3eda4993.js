(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-797fa56e"],{"1f2a":function(e,t,a){},"3e69":function(e,t,a){"use strict";a("b4fb");var s=a("0c6d");function l(e,t,a){return Object(s["a"])({url:"/admin/sysAuth/user/findUsersByPage/".concat(e,"/").concat(t),data:a,method:"POST"})}function r(e){return Object(s["a"])({url:"/admin/sysAuth/user/removeUser/".concat(e),method:"DELETE"})}function o(e){return Object(s["a"])({url:"/admin/sysAuth/user/saveUserRoles",method:"POST",data:e})}function i(e){return Object(s["a"])({url:"/admin/sysAuth/user/updateUserRoles",method:"PUT",data:e})}function n(e){return Object(s["a"])({url:"/admin/sysAuth/user/".concat(e),method:"GET"})}function d(){return Object(s["a"])({url:"/admin/sysAuth/role/findAllRoles",method:"GET"})}function c(e,t){return Object(s["a"])({url:"/admin/sysAuth/role/findRolesByPage/".concat(e,"/").concat(t),method:"GET"})}function u(e){return Object(s["a"])({url:"/admin/sysAuth/role/removeRole/".concat(e),method:"DELETE"})}function h(e){return Object(s["a"])({url:"/admin/sysAuth/role/saveRolePermissions",method:"POST",data:e})}function m(e){return Object(s["a"])({url:"/admin/sysAuth/role/updateRolePermissions",method:"PUT",data:e})}function f(e){return Object(s["a"])({url:"/admin/sysAuth/role/".concat(e),method:"GET"})}function p(){return Object(s["a"])({url:"/admin/sysAuth/permission/findAllPermissions",method:"GET"})}function b(){return Object(s["a"])({url:"/admin/sysAuth/permission/remove/".concat(id),method:"POST"})}function g(e){return Object(s["a"])({url:"/admin/sysAuth/permission/save",method:"POST",data:e})}function k(e){return Object(s["a"])({url:"/admin/sysAuth/permission/saveInitMenus",method:"POST",data:e})}t["a"]={findUsersByPage:l,removeUser:r,saveUserRoles:o,updateUserRoles:i,user:n,findAllRoles:d,findRolesByPage:c,removeRole:u,saveRolePermissions:h,updateRolePermissions:m,role:f,findAllPermissions:p,remove:b,save:g,saveInitMenus:k}},"79f6":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.newAdd}},[e._v("新增")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roleData,border:""}},[a("el-table-column",{attrs:{prop:"roleName",label:"角色名称",width:"180"}}),a("el-table-column",{attrs:{prop:"roleCode",label:"角色编码",width:"180"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),a("el-table-column",{attrs:{prop:"createTime",label:"添加时间"}}),a("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"edit",attrs:{type:"success",size:"mini"},on:{click:function(a){return e.editrole(t.row.id)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.del(t.row.id)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.start,"page-sizes":e.limits,"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"编辑角色",visible:e.dialogFormVisible,width:"20%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"formName",attrs:{"v-loading":e.loading,model:e.addroleForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName",rules:[{required:!0,message:"角色名称不能为空"}]}},[a("el-input",{model:{value:e.addroleForm.roleName,callback:function(t){e.$set(e.addroleForm,"roleName",t)},expression:"addroleForm.roleName"}})],1),a("el-form-item",{attrs:{label:"角色编码",prop:"roleCode"}},[a("el-input",{model:{value:e.addroleForm.roleCode,callback:function(t){e.$set(e.addroleForm,"roleCode",t)},expression:"addroleForm.roleCode"}})],1),a("el-form-item",{attrs:{label:"角色描述"}},[a("el-input",{attrs:{type:"textarea",rows:2},model:{value:e.addroleForm.remark,callback:function(t){e.$set(e.addroleForm,"remark",t)},expression:"addroleForm.remark"}})],1),a("el-form-item",{attrs:{label:"选择菜单"}},[a("div",[a("el-checkbox",{on:{change:e.unFoldAll},model:{value:e.expandcheck,callback:function(t){e.expandcheck=t},expression:"expandcheck"}},[e._v("展开/关闭")]),a("el-checkbox",{on:{change:e.handleCheckAllChange},model:{value:e.allchecked,callback:function(t){e.allchecked=t},expression:"allchecked"}},[e._v("全选/取消权限")])],1),a("el-tree",{ref:"treeData",attrs:{"default-expand-all":e.expandcheck,data:e.treeData,"show-checkbox":"","node-key":"id",props:e.defaultProps},on:{check:e.checkstasus}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e.roleId?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.editUser}},[e._v("确 定")]):a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1)],1)},l=[],r=(a("fe59"),a("b130"),a("90aa"),a("08ba"),a("3e69")),o={data:function(){return{loading:!1,roleId:"",addroleForm:{roleName:"",roleCode:"",remark:"",permissionIds:[]},dialogFormVisible:!1,roleData:[],start:1,limit:10,total:null,limits:[10,20,30],treeData:[],defaultProps:{children:"children",label:"title"},expandcheck:!1,allchecked:!1,alllimit:[]}},watch:{dialogFormVisible:function(){var e=this;this.dialogFormVisible&&this.$nextTick((function(){e.$refs.formName.resetFields(),e.$refs.treeData.setCheckedKeys([]),e.allchecked=!1}))}},methods:{checkstasus:function(e,t){console.log(t),this.addroleForm.permissionIds=t.checkedKeys},unFoldAll:function(e){this.expandcheck=e,this.tree(this.treeData)},tree:function(e){if(this.expandcheck)for(var t=0;t<e.length;t++)e[t].children?(this.$refs.treeData.store.nodesMap[e[t].id].expanded=!0,this.tree(e[t].children)):this.$refs.treeData.store.nodesMap[e[t].id].expanded=!0;else for(var a=0;a<e.length;a++)e[a].children?(this.$refs.treeData.store.nodesMap[e[a].id].expanded=!1,this.tree(e[a].children)):this.$refs.treeData.store.nodesMap[e[a].id].expanded=!1},treeCheck:function(e){for(var t=0;t<e.length;t++)e[t].children?(this.addroleForm.permissionIds.push(e[t].id),this.treeCheck(e[t].children)):this.addroleForm.permissionIds.push(e[t].id)},allLimits:function(e){for(var t=0;t<e.length;t++)this.alllimit.push(e[t])},handleCheckAllChange:function(e){this.allchecked=e,this.allchecked?(this.$refs.treeData.setCheckedNodes(this.treeData),this.treeCheck(this.treeData)):(this.$refs.treeData.setCheckedKeys([]),this.addroleForm.permissionIds=[])},getAllmenu:function(){var e=this;r["a"].findAllPermissions().then((function(t){e.treeData=t.data.menus,e.allLimits(t.data.menus)}))},handleSizeChange:function(e){this.limit=e,this.getAllrole()},handleCurrentChange:function(e){this.start=e,this.getAllrole()},newAdd:function(){this.dialogFormVisible=!0},getAllrole:function(){var e=this;r["a"].findRolesByPage(this.start,this.limit).then((function(t){e.roleData=t.data.rows,e.total=t.data.total}))},editrole:function(e){var t=this;this.loading=!0,this.roleId=e,this.dialogFormVisible=!0,r["a"].role(e).then((function(e){if(e.success){console.log(e);var a=t;if(e.data.role.permissionIds instanceof Object){var s=0;t.alllimit.forEach((function(t){e.data.role.permissionIds.includes(t.id)&&s++})),s==t.alllimit.length&&(t.allchecked=!0),t.$nextTick((function(){e.data.role.permissionIds.forEach((function(e){a.$refs.treeData.setChecked(e,!0,!1)}))}))}else e.data.role.permissionIds=[];t.addroleForm=e.data.role,t.loading=!1}}))},del:function(e){var t=this;r["a"].removeRole(e).then((function(e){e.success&&(t.$message.success("角色删除成功"),t.getAllrole())}))},addUser:function(){var e=this;console.log("增加角色"),r["a"].saveRolePermissions(this.addroleForm).then((function(t){t.success&&(e.$message.success("新增角色成功"),e.dialogFormVisible=!1,e.getAllrole())}))},editUser:function(){var e=this;console.log(this.addroleForm),r["a"].updateRolePermissions(this.addroleForm).then((function(t){console.log(t),t.success&&(e.$message.success("修改成功"),e.dialogFormVisible=!1,e.getAllrole())}))}},created:function(){this.getAllrole(),this.getAllmenu()}},i=o,n=(a("c106"),a("5d22")),d=Object(n["a"])(i,s,l,!1,null,"262f43f9",null);t["default"]=d.exports},c106:function(e,t,a){"use strict";a("1f2a")}}]);